<ion-button (click)="goBack()" class="back-button-floating-new">
  <ion-icon slot="icon-only" name="arrow-back-outline"></ion-icon>
</ion-button>

<ion-content [fullscreen]="true">
  <div class="header-container"> 
    <div class="header-content">
      <ion-title size="large" class="ion-text-center ion-padding-bottom">Únete a MovieApp</ion-title>

      <form [formGroup]="registerForm" (ngSubmit)="onRegister()">
        
        <ion-item fill="outline" class="ion-margin-bottom">
          <input type="text" formControlName="username" placeholder="Nombre de Usuario" class="native-input"/>
        </ion-item>
        <div *ngIf="f['username'].touched && f['username'].errors" class="error-message">
          <p *ngIf="f['username'].errors['required']">El nombre es obligatorio.</p>
          <p *ngIf="f['username'].errors['minlength']">Mínimo 3 caracteres.</p>
        </div>

        <ion-item fill="outline" class="ion-margin-bottom">
          <input type="email" formControlName="email" placeholder="Correo Electrónico" class="native-input"/>
        </ion-item>
        <div *ngIf="f['email'].touched && f['email'].errors" class="error-message">
          <p *ngIf="f['email'].errors['required']">El correo es obligatorio.</p>
          <p *ngIf="f['email'].errors['email']">Formato de correo inválido.</p>
        </div>

        <ion-item fill="outline" class="ion-margin-bottom">
          <input [type]="showPassword ? 'text' : 'password'" formControlName="password" placeholder="Contraseña" class="native-input"/>
          <ion-icon slot="end" 
                    [name]="showPassword ? 'eye-off-outline' : 'eye-outline'"
                    (click)="togglePasswordVisibility()"
                    aria-label="Toggle password visibility"></ion-icon>
        </ion-item>
        <div *ngIf="f['password'].touched && f['password'].errors" class="error-message">
          <p *ngIf="f['password'].errors['required']">La contraseña es obligatoria.</p>
          <p *ngIf="f['password'].errors['minlength']">Mínimo 6 caracteres.</p>
        </div>

        <ion-item fill="outline" class="ion-margin-bottom">
          <input [type]="showConfirmPassword ? 'text' : 'password'" formControlName="confirmPassword" placeholder="Confirmar Contraseña" class="native-input"/>
          <ion-icon slot="end" 
                    [name]="showConfirmPassword ? 'eye-off-outline' : 'eye-outline'"
                    (click)="toggleConfirmPasswordVisibility()"
                    aria-label="Toggle confirm password visibility"></ion-icon>
        </ion-item>
        <div *ngIf="f['confirmPassword'].touched && f['confirmPassword'].errors" class="error-message">
          <p *ngIf="f['confirmPassword'].errors['required']">La confirmación es obligatoria.</p>
        </div>
        <div *ngIf="registerForm.errors?.['passwordsMismatch'] && f['confirmPassword'].touched" class="error-message">
          <p>Las contraseñas no coinciden.</p>
        </div>

        <ion-button expand="block" type="submit" [disabled]="registerForm.invalid" class="ion-margin-top">
          Registrarse
        </ion-button>
      </form>
    </div>
  </div>
</ion-content>